<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 950 750">
  <defs>
    <linearGradient id="layer1Grad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#1e3a5f"/>
      <stop offset="100%" style="stop-color:#2d5a87"/>
    </linearGradient>
    <linearGradient id="layer2Grad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#3498db"/>
      <stop offset="100%" style="stop-color:#2980b9"/>
    </linearGradient>
    <linearGradient id="layer3Grad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#27ae60"/>
      <stop offset="100%" style="stop-color:#1e8449"/>
    </linearGradient>
    <linearGradient id="layer4Grad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f39c12"/>
      <stop offset="100%" style="stop-color:#d68910"/>
    </linearGradient>
    <linearGradient id="layer5Grad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#9b59b6"/>
      <stop offset="100%" style="stop-color:#8e44ad"/>
    </linearGradient>
    <linearGradient id="attackGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#e74c3c"/>
      <stop offset="100%" style="stop-color:#c0392b"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.2"/>
    </filter>
    <marker id="arrowRed" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#e74c3c"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="950" height="750" fill="#f8fafc"/>
  
  <!-- Title -->
  <text x="475" y="35" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#1e3a5f" text-anchor="middle">Diagram 12.9: Strategi Pertahanan Berlapis (Defense in Depth)</text>
  
  <!-- Attacker -->
  <g transform="translate(50, 100)" filter="url(#shadow)">
    <circle cx="40" cy="25" r="22" fill="url(#attackGrad)"/>
    <rect x="18" y="55" width="44" height="55" rx="5" fill="url(#attackGrad)"/>
    <text x="40" y="130" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle" font-weight="bold">Penyerang</text>
    <text x="40" y="145" font-family="Arial, sans-serif" font-size="10" fill="#e74c3c" text-anchor="middle">SQL Injection</text>
  </g>
  
  <!-- Attack Arrow -->
  <path d="M130 130 L200 130" stroke="#e74c3c" stroke-width="3" marker-end="url(#arrowRed)" stroke-dasharray="8,4"/>
  <text x="165" y="120" font-family="Arial, sans-serif" font-size="10" fill="#e74c3c" text-anchor="middle">Serangan</text>
  
  <!-- Layer 1: WAF -->
  <g transform="translate(210, 60)" filter="url(#shadow)">
    <rect x="0" y="0" width="140" height="160" rx="10" fill="white" stroke="url(#layer1Grad)" stroke-width="4"/>
    <rect x="0" y="0" width="140" height="35" rx="10" fill="url(#layer1Grad)"/>
    <rect x="0" y="25" width="140" height="10" fill="url(#layer1Grad)"/>
    <text x="70" y="23" font-family="Arial, sans-serif" font-size="11" fill="white" text-anchor="middle" font-weight="bold">LAPISAN 1</text>
    
    <text x="70" y="55" font-family="Arial, sans-serif" font-size="10" fill="#1e3a5f" text-anchor="middle" font-weight="bold">Web Application</text>
    <text x="70" y="68" font-family="Arial, sans-serif" font-size="10" fill="#1e3a5f" text-anchor="middle" font-weight="bold">Firewall (WAF)</text>
    
    <!-- Shield icon -->
    <path d="M55 85 L70 75 L85 85 L85 110 C85 120 70 130 70 130 C70 130 55 120 55 110 Z" fill="#1e3a5f"/>
    <text x="70" y="108" font-family="Arial, sans-serif" font-size="14" fill="white" text-anchor="middle">ğŸ›¡ï¸</text>
    
    <text x="70" y="150" font-family="Arial, sans-serif" font-size="8" fill="#666" text-anchor="middle">Blokir pola serangan</text>
  </g>
  
  <!-- Layer 2: Input Validation -->
  <g transform="translate(370, 60)" filter="url(#shadow)">
    <rect x="0" y="0" width="140" height="160" rx="10" fill="white" stroke="url(#layer2Grad)" stroke-width="4"/>
    <rect x="0" y="0" width="140" height="35" rx="10" fill="url(#layer2Grad)"/>
    <rect x="0" y="25" width="140" height="10" fill="url(#layer2Grad)"/>
    <text x="70" y="23" font-family="Arial, sans-serif" font-size="11" fill="white" text-anchor="middle" font-weight="bold">LAPISAN 2</text>
    
    <text x="70" y="55" font-family="Arial, sans-serif" font-size="10" fill="#2980b9" text-anchor="middle" font-weight="bold">Validasi &amp;</text>
    <text x="70" y="68" font-family="Arial, sans-serif" font-size="10" fill="#2980b9" text-anchor="middle" font-weight="bold">Sanitasi Input</text>
    
    <!-- Check icon -->
    <circle cx="70" cy="100" r="20" fill="#3498db"/>
    <text x="70" y="107" font-family="Arial, sans-serif" font-size="18" fill="white" text-anchor="middle">âœ“</text>
    
    <text x="70" y="140" font-family="Arial, sans-serif" font-size="8" fill="#666" text-anchor="middle">Whitelist &amp; tipe data</text>
    <text x="70" y="152" font-family="Arial, sans-serif" font-size="8" fill="#666" text-anchor="middle">yang ketat</text>
  </g>
  
  <!-- Layer 3: Parameterized Query -->
  <g transform="translate(530, 60)" filter="url(#shadow)">
    <rect x="0" y="0" width="140" height="160" rx="10" fill="white" stroke="url(#layer3Grad)" stroke-width="4"/>
    <rect x="0" y="0" width="140" height="35" rx="10" fill="url(#layer3Grad)"/>
    <rect x="0" y="25" width="140" height="10" fill="url(#layer3Grad)"/>
    <text x="70" y="23" font-family="Arial, sans-serif" font-size="11" fill="white" text-anchor="middle" font-weight="bold">LAPISAN 3</text>
    
    <text x="70" y="55" font-family="Arial, sans-serif" font-size="10" fill="#1e8449" text-anchor="middle" font-weight="bold">Parameterized</text>
    <text x="70" y="68" font-family="Arial, sans-serif" font-size="10" fill="#1e8449" text-anchor="middle" font-weight="bold">Query</text>
    
    <!-- Code icon -->
    <rect x="45" y="80" width="50" height="35" rx="3" fill="#27ae60"/>
    <text x="70" y="102" font-family="Courier New, monospace" font-size="12" fill="white" text-anchor="middle">{?}</text>
    
    <text x="70" y="140" font-family="Arial, sans-serif" font-size="8" fill="#666" text-anchor="middle">Pemisahan kode</text>
    <text x="70" y="152" font-family="Arial, sans-serif" font-size="8" fill="#666" text-anchor="middle">dan data</text>
  </g>
  
  <!-- Layer 4: Least Privilege -->
  <g transform="translate(690, 60)" filter="url(#shadow)">
    <rect x="0" y="0" width="140" height="160" rx="10" fill="white" stroke="url(#layer4Grad)" stroke-width="4"/>
    <rect x="0" y="0" width="140" height="35" rx="10" fill="url(#layer4Grad)"/>
    <rect x="0" y="25" width="140" height="10" fill="url(#layer4Grad)"/>
    <text x="70" y="23" font-family="Arial, sans-serif" font-size="11" fill="white" text-anchor="middle" font-weight="bold">LAPISAN 4</text>
    
    <text x="70" y="55" font-family="Arial, sans-serif" font-size="10" fill="#d68910" text-anchor="middle" font-weight="bold">Least Privilege</text>
    <text x="70" y="68" font-family="Arial, sans-serif" font-size="10" fill="#d68910" text-anchor="middle" font-weight="bold">Database</text>
    
    <!-- Lock icon -->
    <rect x="55" y="90" width="30" height="25" rx="3" fill="#f39c12"/>
    <circle cx="70" cy="85" r="10" fill="none" stroke="#f39c12" stroke-width="4"/>
    
    <text x="70" y="140" font-family="Arial, sans-serif" font-size="8" fill="#666" text-anchor="middle">Izin minimum</text>
    <text x="70" y="152" font-family="Arial, sans-serif" font-size="8" fill="#666" text-anchor="middle">untuk akun DB</text>
  </g>
  
  <!-- Layer 5: Error Handling -->
  <g transform="translate(850, 60)" filter="url(#shadow)">
    <rect x="0" y="0" width="80" height="160" rx="10" fill="white" stroke="url(#layer5Grad)" stroke-width="4"/>
    <rect x="0" y="0" width="80" height="35" rx="10" fill="url(#layer5Grad)"/>
    <rect x="0" y="25" width="80" height="10" fill="url(#layer5Grad)"/>
    <text x="40" y="23" font-family="Arial, sans-serif" font-size="9" fill="white" text-anchor="middle" font-weight="bold">LAPISAN 5</text>
    
    <text x="40" y="55" font-family="Arial, sans-serif" font-size="8" fill="#8e44ad" text-anchor="middle" font-weight="bold">Error</text>
    <text x="40" y="66" font-family="Arial, sans-serif" font-size="8" fill="#8e44ad" text-anchor="middle" font-weight="bold">Handling</text>
    
    <!-- Warning icon -->
    <text x="40" y="100" font-family="Arial, sans-serif" font-size="24" fill="#9b59b6" text-anchor="middle">âš ï¸</text>
    
    <text x="40" y="135" font-family="Arial, sans-serif" font-size="7" fill="#666" text-anchor="middle">Sembunyikan</text>
    <text x="40" y="145" font-family="Arial, sans-serif" font-size="7" fill="#666" text-anchor="middle">detail error</text>
  </g>
  
  <!-- Database (Protected) -->
  <g transform="translate(850, 250)" filter="url(#shadow)">
    <ellipse cx="40" cy="20" rx="35" ry="15" fill="#27ae60"/>
    <rect x="5" y="20" width="70" height="50" fill="#27ae60"/>
    <ellipse cx="40" cy="70" rx="35" ry="15" fill="#27ae60"/>
    <ellipse cx="40" cy="20" rx="35" ry="15" fill="none" stroke="#1e8449" stroke-width="2"/>
    <text x="40" y="45" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle" font-weight="bold">DATABASE</text>
    <text x="40" y="58" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle">AMAN</text>
    <text x="40" y="100" font-family="Arial, sans-serif" font-size="9" fill="#27ae60" text-anchor="middle">ğŸ”’ Dilindungi</text>
  </g>
  
  <!-- Blocked Attack Indicators -->
  <g transform="translate(280, 180)">
    <text x="0" y="0" font-family="Arial, sans-serif" font-size="16" fill="#e74c3c">âŒ</text>
    <text x="0" y="20" font-family="Arial, sans-serif" font-size="8" fill="#e74c3c">Diblokir</text>
  </g>
  
  <g transform="translate(440, 180)">
    <text x="0" y="0" font-family="Arial, sans-serif" font-size="16" fill="#e74c3c">âŒ</text>
    <text x="0" y="20" font-family="Arial, sans-serif" font-size="8" fill="#e74c3c">Ditolak</text>
  </g>
  
  <g transform="translate(600, 180)">
    <text x="0" y="0" font-family="Arial, sans-serif" font-size="16" fill="#e74c3c">âŒ</text>
    <text x="0" y="20" font-family="Arial, sans-serif" font-size="8" fill="#e74c3c">Dinetralisir</text>
  </g>
  
  <!-- Layer Details Section -->
  <rect x="25" y="340" width="900" height="250" rx="10" fill="white" stroke="#1e3a5f" stroke-width="2"/>
  <text x="475" y="365" font-family="Arial, sans-serif" font-size="14" fill="#1e3a5f" text-anchor="middle" font-weight="bold">Detail Setiap Lapisan Pertahanan</text>
  
  <!-- Detail boxes -->
  <g transform="translate(40, 385)">
    <rect x="0" y="0" width="165" height="90" rx="5" fill="#eaecee"/>
    <rect x="0" y="0" width="165" height="25" rx="5" fill="url(#layer1Grad)"/>
    <text x="82" y="17" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle" font-weight="bold">WAF</text>
    <text x="82" y="45" font-family="Arial, sans-serif" font-size="9" fill="#333" text-anchor="middle">â€¢ Deteksi pola serangan</text>
    <text x="82" y="58" font-family="Arial, sans-serif" font-size="9" fill="#333" text-anchor="middle">â€¢ Filter traffic berbahaya</text>
    <text x="82" y="71" font-family="Arial, sans-serif" font-size="9" fill="#333" text-anchor="middle">â€¢ Logging &amp; monitoring</text>
    <text x="82" y="84" font-family="Arial, sans-serif" font-size="8" fill="#f39c12" text-anchor="middle">Bukan satu-satunya solusi!</text>
  </g>
  
  <g transform="translate(220, 385)">
    <rect x="0" y="0" width="165" height="90" rx="5" fill="#eaecee"/>
    <rect x="0" y="0" width="165" height="25" rx="5" fill="url(#layer2Grad)"/>
    <text x="82" y="17" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle" font-weight="bold">Validasi Input</text>
    <text x="82" y="45" font-family="Arial, sans-serif" font-size="9" fill="#333" text-anchor="middle">â€¢ Whitelist karakter</text>
    <text x="82" y="58" font-family="Arial, sans-serif" font-size="9" fill="#333" text-anchor="middle">â€¢ Tipe data ketat</text>
    <text x="82" y="71" font-family="Arial, sans-serif" font-size="9" fill="#333" text-anchor="middle">â€¢ Batasi panjang input</text>
    <text x="82" y="84" font-family="Arial, sans-serif" font-size="8" fill="#27ae60" text-anchor="middle">Validasi di server-side!</text>
  </g>
  
  <g transform="translate(400, 385)">
    <rect x="0" y="0" width="165" height="90" rx="5" fill="#eaecee"/>
    <rect x="0" y="0" width="165" height="25" rx="5" fill="url(#layer3Grad)"/>
    <text x="82" y="17" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle" font-weight="bold">Parameterized Query</text>
    <text x="82" y="45" font-family="Arial, sans-serif" font-size="9" fill="#333" text-anchor="middle">â€¢ Pisahkan kode &amp; data</text>
    <text x="82" y="58" font-family="Arial, sans-serif" font-size="9" fill="#333" text-anchor="middle">â€¢ Auto-escape karakter</text>
    <text x="82" y="71" font-family="Arial, sans-serif" font-size="9" fill="#333" text-anchor="middle">â€¢ Prepared statements</text>
    <text x="82" y="84" font-family="Arial, sans-serif" font-size="8" fill="#e74c3c" text-anchor="middle" font-weight="bold">â˜… PERTAHANAN UTAMA</text>
  </g>
  
  <g transform="translate(580, 385)">
    <rect x="0" y="0" width="165" height="90" rx="5" fill="#eaecee"/>
    <rect x="0" y="0" width="165" height="25" rx="5" fill="url(#layer4Grad)"/>
    <text x="82" y="17" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle" font-weight="bold">Least Privilege</text>
    <text x="82" y="45" font-family="Arial, sans-serif" font-size="9" fill="#333" text-anchor="middle">â€¢ Akun DB terbatas</text>
    <text x="82" y="58" font-family="Arial, sans-serif" font-size="9" fill="#333" text-anchor="middle">â€¢ Tanpa akses admin</text>
    <text x="82" y="71" font-family="Arial, sans-serif" font-size="9" fill="#333" text-anchor="middle">â€¢ Pisahkan read/write</text>
    <text x="82" y="84" font-family="Arial, sans-serif" font-size="8" fill="#27ae60" text-anchor="middle">Batasi dampak jika bocor</text>
  </g>
  
  <g transform="translate(760, 385)">
    <rect x="0" y="0" width="150" height="90" rx="5" fill="#eaecee"/>
    <rect x="0" y="0" width="150" height="25" rx="5" fill="url(#layer5Grad)"/>
    <text x="75" y="17" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle" font-weight="bold">Error Handling</text>
    <text x="75" y="45" font-family="Arial, sans-serif" font-size="9" fill="#333" text-anchor="middle">â€¢ Pesan error generik</text>
    <text x="75" y="58" font-family="Arial, sans-serif" font-size="9" fill="#333" text-anchor="middle">â€¢ Log detail di server</text>
    <text x="75" y="71" font-family="Arial, sans-serif" font-size="9" fill="#333" text-anchor="middle">â€¢ Nonaktifkan debug</text>
    <text x="75" y="84" font-family="Arial, sans-serif" font-size="8" fill="#27ae60" text-anchor="middle">Jangan bocorkan info!</text>
  </g>
  
  <!-- Additional measures -->
  <g transform="translate(40, 490)">
    <rect x="0" y="0" width="870" height="85" rx="5" fill="#fff3cd" stroke="#f39c12" stroke-width="1"/>
    <text x="435" y="20" font-family="Arial, sans-serif" font-size="11" fill="#856404" text-anchor="middle" font-weight="bold">Langkah Tambahan yang Penting:</text>
    
    <g transform="translate(30, 35)">
      <circle cx="10" cy="8" r="8" fill="#27ae60"/>
      <text x="10" y="12" font-family="Arial, sans-serif" font-size="8" fill="white" text-anchor="middle">1</text>
      <text x="30" y="12" font-family="Arial, sans-serif" font-size="10" fill="#333">Pembaruan &amp; patch reguler</text>
    </g>
    
    <g transform="translate(230, 35)">
      <circle cx="10" cy="8" r="8" fill="#27ae60"/>
      <text x="10" y="12" font-family="Arial, sans-serif" font-size="8" fill="white" text-anchor="middle">2</text>
      <text x="30" y="12" font-family="Arial, sans-serif" font-size="10" fill="#333">Pengujian keamanan berkala</text>
    </g>
    
    <g transform="translate(450, 35)">
      <circle cx="10" cy="8" r="8" fill="#27ae60"/>
      <text x="10" y="12" font-family="Arial, sans-serif" font-size="8" fill="white" text-anchor="middle">3</text>
      <text x="30" y="12" font-family="Arial, sans-serif" font-size="10" fill="#333">Code review keamanan</text>
    </g>
    
    <g transform="translate(650, 35)">
      <circle cx="10" cy="8" r="8" fill="#27ae60"/>
      <text x="10" y="12" font-family="Arial, sans-serif" font-size="8" fill="white" text-anchor="middle">4</text>
      <text x="30" y="12" font-family="Arial, sans-serif" font-size="10" fill="#333">Pelatihan developer</text>
    </g>
    
    <text x="435" y="70" font-family="Arial, sans-serif" font-size="10" fill="#666" text-anchor="middle">Keamanan adalah proses berkelanjutan, bukan produk sekali jadi</text>
  </g>
  
  <!-- Key Insight -->
  <rect x="25" y="610" width="900" height="70" rx="10" fill="#d5f5e3" stroke="#27ae60" stroke-width="2"/>
  <text x="475" y="635" font-family="Arial, sans-serif" font-size="14" fill="#1e8449" text-anchor="middle" font-weight="bold">ğŸ”‘ Prinsip Defense in Depth</text>
  <text x="475" y="660" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">Jangan bergantung pada SATU lapisan pertahanan. Jika satu lapisan gagal,</text>
  <text x="475" y="675" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">lapisan lain akan tetap melindungi sistem Anda.</text>
  
  <!-- Footer -->
  <text x="475" y="730" font-family="Arial, sans-serif" font-size="10" fill="#666" text-anchor="middle">Modul 12 - SQL Injection | Pengantar Keamanan Siber</text>
</svg>
