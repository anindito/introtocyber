<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 950 700">
  <defs>
    <linearGradient id="errorGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#e74c3c"/>
      <stop offset="100%" style="stop-color:#c0392b"/>
    </linearGradient>
    <linearGradient id="unionGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f39c12"/>
      <stop offset="100%" style="stop-color:#d68910"/>
    </linearGradient>
    <linearGradient id="dbGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#9b59b6"/>
      <stop offset="100%" style="stop-color:#8e44ad"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.2"/>
    </filter>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#1e3a5f"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="950" height="700" fill="#f8fafc"/>
  
  <!-- Title -->
  <text x="475" y="35" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#1e3a5f" text-anchor="middle">Diagram 12.4: In-Band SQL Injection</text>
  <text x="475" y="55" font-family="Arial, sans-serif" font-size="14" fill="#666" text-anchor="middle">Hasil serangan ditampilkan langsung di halaman web</text>
  
  <!-- Section A: Error-Based -->
  <rect x="25" y="75" width="440" height="290" rx="10" fill="#fdedec" stroke="#e74c3c" stroke-width="2"/>
  <rect x="25" y="75" width="440" height="40" rx="10" fill="url(#errorGrad)"/>
  <rect x="25" y="105" width="440" height="10" fill="url(#errorGrad)"/>
  <text x="245" y="102" font-family="Arial, sans-serif" font-size="16" fill="white" text-anchor="middle" font-weight="bold">A. Error-Based SQL Injection</text>
  
  <!-- Error-Based Flow -->
  <!-- Step 1: Attacker input -->
  <g transform="translate(50, 135)">
    <rect x="0" y="0" width="180" height="60" rx="5" fill="white" stroke="#e74c3c" stroke-width="2"/>
    <text x="90" y="20" font-family="Arial, sans-serif" font-size="11" fill="#333" text-anchor="middle" font-weight="bold">1. Penyerang Input</text>
    <text x="90" y="40" font-family="Courier New, monospace" font-size="9" fill="#e74c3c" text-anchor="middle">' AND 1=CONVERT(int,</text>
    <text x="90" y="52" font-family="Courier New, monospace" font-size="9" fill="#e74c3c" text-anchor="middle">(SELECT @@version))--</text>
  </g>
  
  <!-- Arrow 1 -->
  <line x1="235" y1="165" x2="255" y2="165" stroke="#1e3a5f" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Step 2: Database Error -->
  <g transform="translate(260, 135)">
    <rect x="0" y="0" width="180" height="60" rx="5" fill="white" stroke="#e74c3c" stroke-width="2"/>
    <text x="90" y="20" font-family="Arial, sans-serif" font-size="11" fill="#333" text-anchor="middle" font-weight="bold">2. Database Error</text>
    <ellipse cx="90" cy="45" rx="25" ry="12" fill="url(#dbGrad)"/>
    <text x="90" y="49" font-family="Arial, sans-serif" font-size="8" fill="white" text-anchor="middle">ERROR!</text>
  </g>
  
  <!-- Arrow 2 -->
  <path d="M350 200 L350 215" stroke="#1e3a5f" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Step 3: Error Message Displayed -->
  <g transform="translate(50, 220)">
    <rect x="0" y="0" width="390" height="130" rx="5" fill="white" stroke="#e74c3c" stroke-width="2"/>
    <text x="195" y="20" font-family="Arial, sans-serif" font-size="11" fill="#333" text-anchor="middle" font-weight="bold">3. Pesan Error Ditampilkan ke Pengguna</text>
    
    <!-- Browser window mockup -->
    <rect x="15" y="35" width="360" height="80" rx="5" fill="#2c3e50"/>
    <circle cx="30" cy="48" r="5" fill="#e74c3c"/>
    <circle cx="45" cy="48" r="5" fill="#f39c12"/>
    <circle cx="60" cy="48" r="5" fill="#27ae60"/>
    
    <rect x="25" y="60" width="340" height="45" fill="#1a252f"/>
    <text x="35" y="78" font-family="Courier New, monospace" font-size="9" fill="#e74c3c">Error: Conversion failed converting</text>
    <text x="35" y="92" font-family="Courier New, monospace" font-size="9" fill="#27ae60">'Microsoft SQL Server 2019'</text>
    <text x="35" y="102" font-family="Courier New, monospace" font-size="9" fill="#e74c3c">to data type int.</text>
  </g>
  
  <!-- Info extracted -->
  <g transform="translate(100, 355)">
    <rect x="0" y="0" width="280" height="25" rx="5" fill="#27ae60"/>
    <text x="140" y="17" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle" font-weight="bold">âœ“ Info Diekstrak: Versi database terungkap!</text>
  </g>
  
  <!-- Section B: Union-Based -->
  <rect x="485" y="75" width="440" height="290" rx="10" fill="#fef5e7" stroke="#f39c12" stroke-width="2"/>
  <rect x="485" y="75" width="440" height="40" rx="10" fill="url(#unionGrad)"/>
  <rect x="485" y="105" width="440" height="10" fill="url(#unionGrad)"/>
  <text x="705" y="102" font-family="Arial, sans-serif" font-size="16" fill="white" text-anchor="middle" font-weight="bold">B. Union-Based SQL Injection</text>
  
  <!-- Union-Based Flow -->
  <!-- Step 1 -->
  <g transform="translate(510, 135)">
    <rect x="0" y="0" width="180" height="60" rx="5" fill="white" stroke="#f39c12" stroke-width="2"/>
    <text x="90" y="20" font-family="Arial, sans-serif" font-size="11" fill="#333" text-anchor="middle" font-weight="bold">1. Penyerang Input</text>
    <text x="90" y="40" font-family="Courier New, monospace" font-size="9" fill="#f39c12" text-anchor="middle">1 UNION SELECT</text>
    <text x="90" y="52" font-family="Courier New, monospace" font-size="9" fill="#f39c12" text-anchor="middle">user,pass FROM users--</text>
  </g>
  
  <!-- Arrow -->
  <line x1="695" y1="165" x2="715" y2="165" stroke="#1e3a5f" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Step 2 -->
  <g transform="translate(720, 135)">
    <rect x="0" y="0" width="180" height="60" rx="5" fill="white" stroke="#f39c12" stroke-width="2"/>
    <text x="90" y="20" font-family="Arial, sans-serif" font-size="11" fill="#333" text-anchor="middle" font-weight="bold">2. Query Gabungan</text>
    <text x="90" y="40" font-family="Courier New, monospace" font-size="8" fill="#333" text-anchor="middle">Original + UNION</text>
    <text x="90" y="52" font-family="Courier New, monospace" font-size="8" fill="#f39c12" text-anchor="middle">= Gabungan hasil</text>
  </g>
  
  <!-- Arrow -->
  <path d="M810 200 L810 215" stroke="#1e3a5f" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Step 3: Combined Result -->
  <g transform="translate(510, 220)">
    <rect x="0" y="0" width="390" height="130" rx="5" fill="white" stroke="#f39c12" stroke-width="2"/>
    <text x="195" y="20" font-family="Arial, sans-serif" font-size="11" fill="#333" text-anchor="middle" font-weight="bold">3. Hasil Gabungan Ditampilkan</text>
    
    <!-- Table result -->
    <rect x="15" y="35" width="360" height="80" rx="3" fill="#ecf0f1"/>
    
    <!-- Table header -->
    <rect x="15" y="35" width="360" height="20" fill="#3498db"/>
    <text x="100" y="49" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle" font-weight="bold">nama_produk</text>
    <text x="280" y="49" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle" font-weight="bold">harga</text>
    
    <!-- Normal row -->
    <text x="100" y="70" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle">Laptop Gaming</text>
    <text x="280" y="70" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle">15000000</text>
    <line x1="15" y1="78" x2="375" y2="78" stroke="#bdc3c7" stroke-width="1"/>
    
    <!-- Injected rows -->
    <rect x="15" y="78" width="360" height="35" fill="#fdebd0"/>
    <text x="100" y="93" font-family="Arial, sans-serif" font-size="10" fill="#e74c3c" text-anchor="middle" font-weight="bold">admin</text>
    <text x="280" y="93" font-family="Arial, sans-serif" font-size="10" fill="#e74c3c" text-anchor="middle" font-weight="bold">secret123</text>
    <text x="100" y="108" font-family="Arial, sans-serif" font-size="10" fill="#e74c3c" text-anchor="middle" font-weight="bold">user1</text>
    <text x="280" y="108" font-family="Arial, sans-serif" font-size="10" fill="#e74c3c" text-anchor="middle" font-weight="bold">pass456</text>
  </g>
  
  <!-- Info extracted -->
  <g transform="translate(560, 355)">
    <rect x="0" y="0" width="280" height="25" rx="5" fill="#27ae60"/>
    <text x="140" y="17" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle" font-weight="bold">âœ“ Info Diekstrak: Kredensial pengguna!</text>
  </g>
  
  <!-- Comparison Section -->
  <rect x="25" y="400" width="900" height="130" rx="10" fill="white" stroke="#1e3a5f" stroke-width="2"/>
  <text x="475" y="425" font-family="Arial, sans-serif" font-size="14" fill="#1e3a5f" text-anchor="middle" font-weight="bold">Perbandingan Teknik In-Band</text>
  
  <!-- Table -->
  <g transform="translate(50, 440)">
    <!-- Headers -->
    <rect x="0" y="0" width="200" height="30" fill="#1e3a5f"/>
    <text x="100" y="20" font-family="Arial, sans-serif" font-size="11" fill="white" text-anchor="middle" font-weight="bold">Aspek</text>
    
    <rect x="200" y="0" width="320" height="30" fill="#e74c3c"/>
    <text x="360" y="20" font-family="Arial, sans-serif" font-size="11" fill="white" text-anchor="middle" font-weight="bold">Error-Based</text>
    
    <rect x="520" y="0" width="330" height="30" fill="#f39c12"/>
    <text x="685" y="20" font-family="Arial, sans-serif" font-size="11" fill="white" text-anchor="middle" font-weight="bold">Union-Based</text>
    
    <!-- Row 1 -->
    <rect x="0" y="30" width="200" height="25" fill="#ecf0f1"/>
    <text x="100" y="47" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle">Cara Kerja</text>
    <rect x="200" y="30" width="320" height="25" fill="#fff"/>
    <text x="360" y="47" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle">Memanfaatkan pesan error database</text>
    <rect x="520" y="30" width="330" height="25" fill="#fff"/>
    <text x="685" y="47" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle">Menggabungkan hasil dengan UNION</text>
    
    <!-- Row 2 -->
    <rect x="0" y="55" width="200" height="25" fill="#ecf0f1"/>
    <text x="100" y="72" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle">Syarat</text>
    <rect x="200" y="55" width="320" height="25" fill="#f8f9fa"/>
    <text x="360" y="72" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle">Error ditampilkan ke pengguna</text>
    <rect x="520" y="55" width="330" height="25" fill="#f8f9fa"/>
    <text x="685" y="72" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle">Jumlah kolom harus cocok</text>
  </g>
  
  <!-- Key Characteristic -->
  <rect x="25" y="545" width="900" height="80" rx="10" fill="#d5f5e3" stroke="#27ae60" stroke-width="2"/>
  <text x="475" y="575" font-family="Arial, sans-serif" font-size="14" fill="#1e8449" text-anchor="middle" font-weight="bold">ðŸ”‘ Karakteristik Utama In-Band SQL Injection</text>
  <text x="475" y="600" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">Penyerang mengirim payload dan menerima hasil melalui SALURAN YANG SAMA (halaman web)</text>
  <text x="475" y="618" font-family="Arial, sans-serif" font-size="11" fill="#666" text-anchor="middle">Ini adalah tipe SQL injection yang paling mudah dieksploitasi karena hasil langsung terlihat</text>
  
  <!-- Footer -->
  <text x="475" y="680" font-family="Arial, sans-serif" font-size="10" fill="#666" text-anchor="middle">Modul 12 - SQL Injection | Pengantar Keamanan Siber</text>
</svg>
