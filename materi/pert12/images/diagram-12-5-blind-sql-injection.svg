<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 950 750">
  <defs>
    <linearGradient id="booleanGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#3498db"/>
      <stop offset="100%" style="stop-color:#2980b9"/>
    </linearGradient>
    <linearGradient id="timeGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#9b59b6"/>
      <stop offset="100%" style="stop-color:#8e44ad"/>
    </linearGradient>
    <linearGradient id="trueGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#27ae60"/>
      <stop offset="100%" style="stop-color:#1e8449"/>
    </linearGradient>
    <linearGradient id="falseGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#e74c3c"/>
      <stop offset="100%" style="stop-color:#c0392b"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.2"/>
    </filter>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#1e3a5f"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="950" height="750" fill="#f8fafc"/>
  
  <!-- Title -->
  <text x="475" y="35" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#1e3a5f" text-anchor="middle">Diagram 12.5: Blind SQL Injection</text>
  <text x="475" y="55" font-family="Arial, sans-serif" font-size="14" fill="#666" text-anchor="middle">Hasil tidak ditampilkan langsung - penyerang harus "menebak" dari respons</text>
  
  <!-- Section A: Boolean-Based -->
  <rect x="25" y="75" width="440" height="340" rx="10" fill="#ebf5fb" stroke="#3498db" stroke-width="2"/>
  <rect x="25" y="75" width="440" height="40" rx="10" fill="url(#booleanGrad)"/>
  <rect x="25" y="105" width="440" height="10" fill="url(#booleanGrad)"/>
  <text x="245" y="102" font-family="Arial, sans-serif" font-size="16" fill="white" text-anchor="middle" font-weight="bold">A. Boolean-Based Blind Injection</text>
  
  <!-- Boolean explanation -->
  <g transform="translate(45, 130)">
    <rect x="0" y="0" width="400" height="40" rx="5" fill="white" stroke="#3498db" stroke-width="1"/>
    <text x="200" y="17" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle">Penyerang mengamati perbedaan respons aplikasi</text>
    <text x="200" y="32" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle">berdasarkan kondisi TRUE atau FALSE</text>
  </g>
  
  <!-- Boolean Flow Diagram -->
  <!-- Input -->
  <g transform="translate(145, 185)">
    <rect x="0" y="0" width="200" height="45" rx="5" fill="white" stroke="#3498db" stroke-width="2"/>
    <text x="100" y="17" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle" font-weight="bold">Payload:</text>
    <text x="100" y="35" font-family="Courier New, monospace" font-size="8" fill="#3498db" text-anchor="middle">id=1 AND SUBSTRING(pass,1,1)='a'</text>
  </g>
  
  <!-- Split arrow -->
  <path d="M245 235 L245 255 L145 270" stroke="#1e3a5f" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  <path d="M245 235 L245 255 L345 270" stroke="#1e3a5f" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  
  <!-- TRUE Response -->
  <g transform="translate(45, 275)">
    <rect x="0" y="0" width="180" height="80" rx="8" fill="url(#trueGrad)"/>
    <text x="90" y="25" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle" font-weight="bold">Jika TRUE ✓</text>
    <rect x="15" y="35" width="150" height="35" rx="3" fill="white"/>
    <text x="90" y="50" font-family="Arial, sans-serif" font-size="9" fill="#333" text-anchor="middle">Halaman normal</text>
    <text x="90" y="62" font-family="Arial, sans-serif" font-size="9" fill="#27ae60" text-anchor="middle" font-weight="bold">"Produk ditemukan"</text>
  </g>
  
  <!-- FALSE Response -->
  <g transform="translate(265, 275)">
    <rect x="0" y="0" width="180" height="80" rx="8" fill="url(#falseGrad)"/>
    <text x="90" y="25" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle" font-weight="bold">Jika FALSE ✗</text>
    <rect x="15" y="35" width="150" height="35" rx="3" fill="white"/>
    <text x="90" y="50" font-family="Arial, sans-serif" font-size="9" fill="#333" text-anchor="middle">Halaman berbeda</text>
    <text x="90" y="62" font-family="Arial, sans-serif" font-size="9" fill="#e74c3c" text-anchor="middle" font-weight="bold">"Tidak ditemukan"</text>
  </g>
  
  <!-- Result box -->
  <g transform="translate(45, 370)">
    <rect x="0" y="0" width="400" height="35" rx="5" fill="#d5f5e3" stroke="#27ae60" stroke-width="1"/>
    <text x="200" y="22" font-family="Arial, sans-serif" font-size="11" fill="#1e8449" text-anchor="middle" font-weight="bold">→ Kesimpulan: Jika TRUE, karakter pertama password = 'a'</text>
  </g>
  
  <!-- Section B: Time-Based -->
  <rect x="485" y="75" width="440" height="340" rx="10" fill="#f4ecf7" stroke="#9b59b6" stroke-width="2"/>
  <rect x="485" y="75" width="440" height="40" rx="10" fill="url(#timeGrad)"/>
  <rect x="485" y="105" width="440" height="10" fill="url(#timeGrad)"/>
  <text x="705" y="102" font-family="Arial, sans-serif" font-size="16" fill="white" text-anchor="middle" font-weight="bold">B. Time-Based Blind Injection</text>
  
  <!-- Time explanation -->
  <g transform="translate(505, 130)">
    <rect x="0" y="0" width="400" height="40" rx="5" fill="white" stroke="#9b59b6" stroke-width="1"/>
    <text x="200" y="17" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle">Penyerang mengukur waktu respons server</text>
    <text x="200" y="32" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle">untuk menentukan TRUE atau FALSE</text>
  </g>
  
  <!-- Time Flow Diagram -->
  <!-- Input -->
  <g transform="translate(605, 185)">
    <rect x="0" y="0" width="200" height="45" rx="5" fill="white" stroke="#9b59b6" stroke-width="2"/>
    <text x="100" y="17" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle" font-weight="bold">Payload:</text>
    <text x="100" y="35" font-family="Courier New, monospace" font-size="8" fill="#9b59b6" text-anchor="middle">IF(pass='a') WAITFOR DELAY '5'</text>
  </g>
  
  <!-- Split arrow -->
  <path d="M705 235 L705 255 L605 270" stroke="#1e3a5f" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  <path d="M705 235 L705 255 L805 270" stroke="#1e3a5f" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  
  <!-- TRUE Response (Delayed) -->
  <g transform="translate(505, 275)">
    <rect x="0" y="0" width="180" height="80" rx="8" fill="url(#trueGrad)"/>
    <text x="90" y="25" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle" font-weight="bold">Jika TRUE ✓</text>
    <rect x="15" y="35" width="150" height="35" rx="3" fill="white"/>
    <!-- Clock icon -->
    <circle cx="50" cy="52" r="12" fill="none" stroke="#27ae60" stroke-width="2"/>
    <line x1="50" y1="52" x2="50" y2="45" stroke="#27ae60" stroke-width="2"/>
    <line x1="50" y1="52" x2="56" y2="52" stroke="#27ae60" stroke-width="2"/>
    <text x="110" y="52" font-family="Arial, sans-serif" font-size="10" fill="#27ae60" text-anchor="middle" font-weight="bold">5 detik delay</text>
  </g>
  
  <!-- FALSE Response (Fast) -->
  <g transform="translate(725, 275)">
    <rect x="0" y="0" width="180" height="80" rx="8" fill="url(#falseGrad)"/>
    <text x="90" y="25" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle" font-weight="bold">Jika FALSE ✗</text>
    <rect x="15" y="35" width="150" height="35" rx="3" fill="white"/>
    <!-- Fast icon -->
    <text x="50" y="58" font-family="Arial, sans-serif" font-size="18" fill="#e74c3c" text-anchor="middle">⚡</text>
    <text x="110" y="52" font-family="Arial, sans-serif" font-size="10" fill="#e74c3c" text-anchor="middle" font-weight="bold">Respons cepat</text>
  </g>
  
  <!-- Result box -->
  <g transform="translate(505, 370)">
    <rect x="0" y="0" width="400" height="35" rx="5" fill="#e8daef" stroke="#9b59b6" stroke-width="1"/>
    <text x="200" y="22" font-family="Arial, sans-serif" font-size="11" fill="#6c3483" text-anchor="middle" font-weight="bold">→ Kesimpulan: Jika delay 5 detik, karakter = 'a'</text>
  </g>
  
  <!-- Character Extraction Process -->
  <rect x="25" y="430" width="900" height="160" rx="10" fill="white" stroke="#1e3a5f" stroke-width="2"/>
  <text x="475" y="455" font-family="Arial, sans-serif" font-size="14" fill="#1e3a5f" text-anchor="middle" font-weight="bold">Proses Ekstraksi Karakter demi Karakter</text>
  
  <!-- Character boxes -->
  <g transform="translate(50, 475)">
    <text x="0" y="15" font-family="Arial, sans-serif" font-size="11" fill="#333">Password: </text>
    
    <!-- Char 1 -->
    <rect x="80" y="0" width="35" height="35" rx="3" fill="#27ae60"/>
    <text x="97" y="23" font-family="Courier New, monospace" font-size="16" fill="white" text-anchor="middle" font-weight="bold">s</text>
    
    <!-- Char 2 -->
    <rect x="120" y="0" width="35" height="35" rx="3" fill="#27ae60"/>
    <text x="137" y="23" font-family="Courier New, monospace" font-size="16" fill="white" text-anchor="middle" font-weight="bold">e</text>
    
    <!-- Char 3 -->
    <rect x="160" y="0" width="35" height="35" rx="3" fill="#27ae60"/>
    <text x="177" y="23" font-family="Courier New, monospace" font-size="16" fill="white" text-anchor="middle" font-weight="bold">c</text>
    
    <!-- Char 4 -->
    <rect x="200" y="0" width="35" height="35" rx="3" fill="#27ae60"/>
    <text x="217" y="23" font-family="Courier New, monospace" font-size="16" fill="white" text-anchor="middle" font-weight="bold">r</text>
    
    <!-- Char 5 -->
    <rect x="240" y="0" width="35" height="35" rx="3" fill="#27ae60"/>
    <text x="257" y="23" font-family="Courier New, monospace" font-size="16" fill="white" text-anchor="middle" font-weight="bold">e</text>
    
    <!-- Char 6 -->
    <rect x="280" y="0" width="35" height="35" rx="3" fill="#27ae60"/>
    <text x="297" y="23" font-family="Courier New, monospace" font-size="16" fill="white" text-anchor="middle" font-weight="bold">t</text>
    
    <!-- Current char being tested -->
    <rect x="320" y="0" width="35" height="35" rx="3" fill="#f39c12" stroke="#e74c3c" stroke-width="2" stroke-dasharray="4"/>
    <text x="337" y="23" font-family="Courier New, monospace" font-size="16" fill="white" text-anchor="middle" font-weight="bold">?</text>
    
    <!-- Remaining -->
    <rect x="360" y="0" width="35" height="35" rx="3" fill="#bdc3c7"/>
    <text x="377" y="23" font-family="Courier New, monospace" font-size="16" fill="white" text-anchor="middle">?</text>
    
    <rect x="400" y="0" width="35" height="35" rx="3" fill="#bdc3c7"/>
    <text x="417" y="23" font-family="Courier New, monospace" font-size="16" fill="white" text-anchor="middle">?</text>
  </g>
  
  <!-- Testing progress -->
  <g transform="translate(500, 475)">
    <rect x="0" y="0" width="370" height="80" rx="5" fill="#ecf0f1"/>
    <text x="185" y="20" font-family="Arial, sans-serif" font-size="11" fill="#333" text-anchor="middle" font-weight="bold">Sedang menguji posisi ke-7:</text>
    <text x="185" y="40" font-family="Courier New, monospace" font-size="9" fill="#666" text-anchor="middle">Mencoba: 'a' → FALSE (cepat)</text>
    <text x="185" y="55" font-family="Courier New, monospace" font-size="9" fill="#666" text-anchor="middle">Mencoba: 'b' → FALSE (cepat)</text>
    <text x="185" y="70" font-family="Courier New, monospace" font-size="9" fill="#f39c12" text-anchor="middle" font-weight="bold">Mencoba: '1' → sedang diuji...</text>
  </g>
  
  <!-- Statistics -->
  <g transform="translate(50, 555)">
    <rect x="0" y="0" width="820" height="25" rx="3" fill="#fef5e7"/>
    <text x="410" y="17" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle">⏱️ Untuk password 8 karakter dengan 62 kemungkinan (a-z, A-Z, 0-9) = ~200-500 permintaan dengan binary search</text>
  </g>
  
  <!-- Key Difference -->
  <rect x="25" y="605" width="900" height="75" rx="10" fill="#fef5e7" stroke="#f39c12" stroke-width="2"/>
  <text x="475" y="630" font-family="Arial, sans-serif" font-size="14" fill="#d68910" text-anchor="middle" font-weight="bold">⚠️ Perbedaan Utama dengan In-Band</text>
  <text x="475" y="655" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">Blind injection lebih LAMBAT karena mengekstrak data satu karakter pada satu waktu</text>
  <text x="475" y="673" font-family="Arial, sans-serif" font-size="11" fill="#666" text-anchor="middle">Tetapi tetap berbahaya karena semua data bisa diekstrak dengan cukup permintaan dan waktu</text>
  
  <!-- Footer -->
  <text x="475" y="730" font-family="Arial, sans-serif" font-size="10" fill="#666" text-anchor="middle">Modul 12 - SQL Injection | Pengantar Keamanan Siber</text>
</svg>
