<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 700">
  <!-- Title -->
  <text x="450" y="30" font-family="Arial, sans-serif" font-size="22" font-weight="bold" text-anchor="middle" fill="#2c3e50">
    Alur Serangan Cross-Site Request Forgery (CSRF)
  </text>
  
  <!-- Step 0: User logs in -->
  <g id="step0">
    <rect x="50" y="70" width="800" height="80" rx="10" fill="#d1ecf1" stroke="#17a2b8" stroke-width="2"/>
    <circle cx="100" cy="110" r="30" fill="#3498db" stroke="#2980b9" stroke-width="2"/>
    <text x="100" y="118" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">
      Pengguna
    </text>
    
    <text x="160" y="95" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#0c5460">
      Langkah 0: Pengguna Login ke Website Bank
    </text>
    <text x="160" y="118" font-family="Arial, sans-serif" font-size="11" fill="#0c5460">
      Pengguna berhasil login, browser menyimpan session cookie
    </text>
    
    <rect x="600" y="85" width="220" height="50" rx="5" fill="#fff3cd" stroke="#ffc107" stroke-width="1"/>
    <text x="710" y="105" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#856404">
      Cookie: session=abc123xyz
    </text>
    <text x="710" y="125" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#856404">
      (Disimpan di browser pengguna)
    </text>
  </g>
  
  <!-- Step 1: Attacker creates malicious page -->
  <g id="step1">
    <rect x="50" y="180" width="380" height="160" rx="10" fill="#f8d7da" stroke="#dc3545" stroke-width="2"/>
    
    <circle cx="100" cy="230" r="30" fill="#e74c3c" stroke="#c0392b" stroke-width="2"/>
    <text x="100" y="238" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">
      Penyerang
    </text>
    
    <text x="160" y="210" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#721c24">
      Langkah 1: Membuat Halaman Berbahaya
    </text>
    
    <!-- Malicious page code -->
    <rect x="160" y="220" width="250" height="100" rx="5" fill="#343a40" stroke="#000000" stroke-width="1"/>
    <text x="170" y="240" font-family="Courier New, monospace" font-size="9" fill="#28a745">
      &lt;form action="http://bank.com/transfer"&gt;
    </text>
    <text x="170" y="255" font-family="Courier New, monospace" font-size="9" fill="#28a745">
        &lt;input name="to" value="attacker"/&gt;
    </text>
    <text x="170" y="270" font-family="Courier New, monospace" font-size="9" fill="#28a745">
        &lt;input name="amount" value="1000000"/&gt;
    </text>
    <text x="170" y="285" font-family="Courier New, monospace" font-size="9" fill="#28a745">
      &lt;/form&gt;
    </text>
    <text x="170" y="300" font-family="Courier New, monospace" font-size="9" fill="#ffc107">
      &lt;script&gt;
    </text>
    <text x="170" y="313" font-family="Courier New, monospace" font-size="9" fill="#ffc107">
        document.forms[0].submit();
    </text>
  </g>
  
  <!-- Arrow Step 1 to 2 -->
  <defs>
    <marker id="arrow1" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#e74c3c" />
    </marker>
  </defs>
  <path d="M 430 260 L 470 260" stroke="#e74c3c" stroke-width="3" marker-end="url(#arrow1)"/>
  <text x="450" y="250" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="#e74c3c">
    Kirim Link
  </text>
  
  <!-- Step 2: Victim visits malicious page -->
  <g id="step2">
    <rect x="470" y="180" width="380" height="160" rx="10" fill="#fff3cd" stroke="#ffc107" stroke-width="2"/>
    
    <circle cx="520" cy="230" r="30" fill="#3498db" stroke="#2980b9" stroke-width="2"/>
    <text x="520" y="238" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">
      Korban
    </text>
    
    <text x="580" y="210" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#856404">
      Langkah 2: Korban Mengklik Link
    </text>
    <text x="580" y="235" font-family="Arial, sans-serif" font-size="11" fill="#856404">
      Email phishing: "Klik untuk hadiah!"
    </text>
    <text x="580" y="255" font-family="Arial, sans-serif" font-size="11" fill="#856404">
      Korban membuka halaman berbahaya
    </text>
    <text x="580" y="275" font-family="Arial, sans-serif" font-size="11" fill="#856404">
      Form auto-submit ke bank.com
    </text>
    
    <!-- Browser icon -->
    <rect x="700" y="290" width="120" height="35" rx="5" fill="#3498db" stroke="#2980b9" stroke-width="2"/>
    <text x="760" y="310" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
      Browser mengirim
    </text>
  </g>
  
  <!-- Step 3: Malicious request -->
  <g id="step3">
    <rect x="50" y="370" width="800" height="140" rx="10" fill="#ffe5e5" stroke="#e74c3c" stroke-width="3"/>
    
    <text x="450" y="395" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#c0392b">
      Langkah 3: Request Berbahaya Terkirim ke Server Bank
    </text>
    
    <!-- Request details -->
    <rect x="100" y="410" width="300" height="85" rx="5" fill="#343a40" stroke="#000000" stroke-width="1"/>
    <text x="110" y="430" font-family="Courier New, monospace" font-size="10" fill="#28a745">
      POST /transfer HTTP/1.1
    </text>
    <text x="110" y="448" font-family="Courier New, monospace" font-size="10" fill="#ffc107">
      Host: bank.com
    </text>
    <text x="110" y="466" font-family="Courier New, monospace" font-size="10" fill="#17a2b8">
      Cookie: session=abc123xyz
    </text>
    <text x="110" y="484" font-family="Courier New, monospace" font-size="10" fill="#e74c3c">
      to=attacker&amp;amount=1000000
    </text>
    
    <!-- Server icon -->
    <rect x="450" y="420" width="120" height="70" rx="5" fill="#95a5a6" stroke="#7f8c8d" stroke-width="2"/>
    <rect x="465" y="430" width="90" height="15" fill="#ecf0f1"/>
    <rect x="465" y="450" width="90" height="15" fill="#ecf0f1"/>
    <rect x="465" y="470" width="90" height="15" fill="#ecf0f1"/>
    <text x="510" y="425" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="#2c3e50">
      Server Bank
    </text>
    
    <!-- Server thinking -->
    <rect x="620" y="410" width="210" height="85" rx="5" fill="#d4edda" stroke="#28a745" stroke-width="1"/>
    <text x="725" y="430" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="#155724">
      Server berpikir:
    </text>
    <text x="630" y="450" font-family="Arial, sans-serif" font-size="10" fill="#155724">
      âœ“ Cookie valid
    </text>
    <text x="630" y="468" font-family="Arial, sans-serif" font-size="10" fill="#155724">
      âœ“ User terautentikasi
    </text>
    <text x="630" y="486" font-family="Arial, sans-serif" font-size="10" fill="#155724">
      â†’ Request DIPROSES!
    </text>
  </g>
  
  <!-- Step 4: Transfer executed -->
  <g id="step4">
    <rect x="50" y="540" width="380" height="120" rx="10" fill="#d4edda" stroke="#28a745" stroke-width="2"/>
    
    <text x="240" y="565" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#155724">
      Langkah 4: Transfer Berhasil!
    </text>
    
    <circle cx="120" cy="610" r="30" fill="#e74c3c" stroke="#c0392b" stroke-width="2"/>
    <text x="120" y="608" font-family="Arial, sans-serif" font-size="20" text-anchor="middle" fill="white">ðŸ’°</text>
    <text x="120" y="625" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="white">Penyerang</text>
    
    <text x="180" y="600" font-family="Arial, sans-serif" font-size="11" fill="#155724">
      Dana ditransfer ke rekening penyerang
    </text>
    <text x="180" y="620" font-family="Arial, sans-serif" font-size="11" fill="#155724">
      Pengguna tidak menyadari apa yang terjadi
    </text>
    <text x="180" y="640" font-family="Arial, sans-serif" font-size="11" fill="#155724">
      Serangan CSRF berhasil!
    </text>
  </g>
  
  <!-- Prevention -->
  <g id="prevention">
    <rect x="470" y="540" width="380" height="120" rx="10" fill="#cce5ff" stroke="#007bff" stroke-width="2"/>
    
    <text x="660" y="565" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#004085">
      Cara Mencegah CSRF:
    </text>
    
    <text x="490" y="590" font-family="Arial, sans-serif" font-size="10" fill="#004085">
      âœ“ <tspan font-weight="bold">Anti-CSRF Token:</tspan> Token unik untuk setiap request
    </text>
    <text x="490" y="610" font-family="Arial, sans-serif" font-size="10" fill="#004085">
      âœ“ <tspan font-weight="bold">SameSite Cookie:</tspan> Cookie tidak dikirim cross-site
    </text>
    <text x="490" y="630" font-family="Arial, sans-serif" font-size="10" fill="#004085">
      âœ“ <tspan font-weight="bold">Re-authentication:</tspan> Minta password untuk aksi sensitif
    </text>
    <text x="490" y="650" font-family="Arial, sans-serif" font-size="10" fill="#004085">
      âœ“ <tspan font-weight="bold">Referer Check:</tspan> Validasi asal request
    </text>
  </g>
  
  <!-- Key Point -->
  <rect x="50" y="675" width="800" height="20" rx="5" fill="#17a2b8"/>
  <text x="450" y="690" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="white">
    POIN KUNCI: CSRF memanfaatkan kepercayaan website terhadap browser pengguna yang terautentikasi
  </text>
</svg>
