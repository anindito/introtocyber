<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 800">
  <!-- Title -->
  <text x="500" y="30" font-family="Arial, sans-serif" font-size="22" font-weight="bold" text-anchor="middle" fill="#2c3e50">
    Tipe-tipe Serangan Cross-Site Scripting (XSS)
  </text>
  
  <!-- Reflected XSS -->
  <g id="reflected-xss">
    <rect x="50" y="60" width="280" height="220" rx="10" fill="#fff3cd" stroke="#ffc107" stroke-width="3"/>
    <text x="190" y="90" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#856404">
      1. Reflected XSS
    </text>
    <text x="190" y="110" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#856404">
      (Non-Persistent)
    </text>
    
    <!-- Attacker -->
    <circle cx="90" cy="150" r="25" fill="#e74c3c" stroke="#c0392b" stroke-width="2"/>
    <text x="90" y="158" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="white">
      Penyerang
    </text>
    
    <!-- Victim -->
    <circle cx="290" cy="230" r="25" fill="#3498db" stroke="#2980b9" stroke-width="2"/>
    <text x="290" y="238" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="white">
      Korban
    </text>
    
    <!-- Server -->
    <rect x="150" y="140" width="70" height="50" rx="5" fill="#95a5a6" stroke="#7f8c8d" stroke-width="2"/>
    <text x="185" y="160" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
      Server
    </text>
    <text x="185" y="175" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
      Vulnerable
    </text>
    
    <!-- Arrows -->
    <defs>
      <marker id="arrow-r1" markerWidth="8" markerHeight="8" refX="7" refY="3" orient="auto">
        <polygon points="0 0, 8 3, 0 6" fill="#e74c3c" />
      </marker>
      <marker id="arrow-r2" markerWidth="8" markerHeight="8" refX="7" refY="3" orient="auto">
        <polygon points="0 0, 8 3, 0 6" fill="#9b59b6" />
      </marker>
      <marker id="arrow-r3" markerWidth="8" markerHeight="8" refX="7" refY="3" orient="auto">
        <polygon points="0 0, 8 3, 0 6" fill="#c0392b" />
      </marker>
    </defs>
    
    <path d="M 115 150 L 150 155" stroke="#e74c3c" stroke-width="2" marker-end="url(#arrow-r1)"/>
    <text x="133" y="145" font-family="Arial, sans-serif" font-size="9" fill="#e74c3c">①</text>
    
    <path d="M 220 170 L 265 210" stroke="#9b59b6" stroke-width="2" marker-end="url(#arrow-r2)"/>
    <text x="245" y="190" font-family="Arial, sans-serif" font-size="9" fill="#9b59b6">②</text>
    
    <path d="M 265 235 L 220 250 L 185 240" stroke="#c0392b" stroke-width="2" marker-end="url(#arrow-r3)" fill="none"/>
    <text x="230" y="255" font-family="Arial, sans-serif" font-size="9" fill="#c0392b">③</text>
    
    <!-- Description -->
    <text x="60" y="210" font-family="Arial, sans-serif" font-size="10" fill="#856404">
      ① Penyerang membuat URL berbahaya
    </text>
    <text x="60" y="225" font-family="Arial, sans-serif" font-size="10" fill="#856404">
      ② Korban mengklik link tersebut
    </text>
    <text x="60" y="240" font-family="Arial, sans-serif" font-size="10" fill="#856404">
      ③ Script di-reflect dari server
    </text>
    <text x="60" y="255" font-family="Arial, sans-serif" font-size="10" fill="#856404">
      ④ Browser eksekusi script berbahaya
    </text>
  </g>
  
  <!-- Stored XSS -->
  <g id="stored-xss">
    <rect x="360" y="60" width="280" height="220" rx="10" fill="#f8d7da" stroke="#dc3545" stroke-width="3"/>
    <text x="500" y="90" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#721c24">
      2. Stored XSS
    </text>
    <text x="500" y="110" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#721c24">
      (Persistent)
    </text>
    
    <!-- Attacker -->
    <circle cx="400" cy="150" r="25" fill="#e74c3c" stroke="#c0392b" stroke-width="2"/>
    <text x="400" y="158" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="white">
      Penyerang
    </text>
    
    <!-- Server with Database -->
    <rect x="465" y="135" width="70" height="60" rx="5" fill="#95a5a6" stroke="#7f8c8d" stroke-width="2"/>
    <text x="500" y="155" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
      Server
    </text>
    <ellipse cx="500" cy="180" rx="25" ry="10" fill="#34495e" stroke="#2c3e50" stroke-width="1"/>
    <text x="500" y="183" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="white">
      Database
    </text>
    
    <!-- Victim -->
    <circle cx="600" cy="230" r="25" fill="#3498db" stroke="#2980b9" stroke-width="2"/>
    <text x="600" y="238" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="white">
      Korban
    </text>
    
    <!-- Arrows -->
    <defs>
      <marker id="arrow-s1" markerWidth="8" markerHeight="8" refX="7" refY="3" orient="auto">
        <polygon points="0 0, 8 3, 0 6" fill="#e74c3c" />
      </marker>
      <marker id="arrow-s2" markerWidth="8" markerHeight="8" refX="7" refY="3" orient="auto">
        <polygon points="0 0, 8 3, 0 6" fill="#9b59b6" />
      </marker>
      <marker id="arrow-s3" markerWidth="8" markerHeight="8" refX="7" refY="3" orient="auto">
        <polygon points="0 0, 8 3, 0 6" fill="#c0392b" />
      </marker>
    </defs>
    
    <path d="M 425 155 L 465 160" stroke="#e74c3c" stroke-width="2" marker-end="url(#arrow-s1)"/>
    <text x="445" y="150" font-family="Arial, sans-serif" font-size="9" fill="#e74c3c">①</text>
    
    <path d="M 535 170 L 575 210" stroke="#9b59b6" stroke-width="2" marker-end="url(#arrow-s2)"/>
    <text x="555" y="190" font-family="Arial, sans-serif" font-size="9" fill="#9b59b6">②</text>
    
    <path d="M 575 235 L 535 240" stroke="#c0392b" stroke-width="2" marker-end="url(#arrow-s3)"/>
    <text x="555" y="250" font-family="Arial, sans-serif" font-size="9" fill="#c0392b">③</text>
    
    <!-- Description -->
    <text x="370" y="210" font-family="Arial, sans-serif" font-size="10" fill="#721c24">
      ① Penyerang inject script ke server
    </text>
    <text x="370" y="225" font-family="Arial, sans-serif" font-size="10" fill="#721c24">
      ② Script disimpan di database
    </text>
    <text x="370" y="240" font-family="Arial, sans-serif" font-size="10" fill="#721c24">
      ③ Korban mengakses halaman
    </text>
    <text x="370" y="255" font-family="Arial, sans-serif" font-size="10" fill="#721c24">
      ④ Script dieksekusi di browser
    </text>
  </g>
  
  <!-- DOM-based XSS -->
  <g id="dom-xss">
    <rect x="670" y="60" width="280" height="220" rx="10" fill="#d1ecf1" stroke="#17a2b8" stroke-width="3"/>
    <text x="810" y="90" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#0c5460">
      3. DOM-based XSS
    </text>
    <text x="810" y="110" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#0c5460">
      (Client-Side)
    </text>
    
    <!-- Attacker -->
    <circle cx="710" cy="150" r="25" fill="#e74c3c" stroke="#c0392b" stroke-width="2"/>
    <text x="710" y="158" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="white">
      Penyerang
    </text>
    
    <!-- Victim Browser -->
    <rect x="775" y="135" width="100" height="70" rx="5" fill="#3498db" stroke="#2980b9" stroke-width="2"/>
    <text x="825" y="155" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
      Browser Korban
    </text>
    <text x="825" y="170" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="white">
      JavaScript
    </text>
    <text x="825" y="185" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="white">
      memodifikasi
    </text>
    <text x="825" y="198" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="white">
      DOM
    </text>
    
    <!-- Arrows -->
    <defs>
      <marker id="arrow-d1" markerWidth="8" markerHeight="8" refX="7" refY="3" orient="auto">
        <polygon points="0 0, 8 3, 0 6" fill="#e74c3c" />
      </marker>
      <marker id="arrow-d2" markerWidth="8" markerHeight="8" refX="7" refY="3" orient="auto">
        <polygon points="0 0, 8 3, 0 6" fill="#c0392b" />
      </marker>
    </defs>
    
    <path d="M 735 160 L 775 165" stroke="#e74c3c" stroke-width="2" marker-end="url(#arrow-d1)"/>
    <text x="755" y="155" font-family="Arial, sans-serif" font-size="9" fill="#e74c3c">①</text>
    
    <ellipse cx="825" cy="230" rx="30" ry="20" fill="#e74c3c" opacity="0.3" stroke="#c0392b" stroke-width="2"/>
    <text x="825" y="235" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#c0392b">
      Eksekusi
    </text>
    
    <path d="M 825 205 L 825 215" stroke="#c0392b" stroke-width="2" marker-end="url(#arrow-d2)"/>
    <text x="850" y="215" font-family="Arial, sans-serif" font-size="9" fill="#c0392b">②</text>
    
    <!-- Description -->
    <text x="680" y="220" font-family="Arial, sans-serif" font-size="10" fill="#0c5460">
      ① Penyerang membuat URL/input
    </text>
    <text x="680" y="235" font-family="Arial, sans-serif" font-size="10" fill="#0c5460">
      ② Script diproses di client-side
    </text>
    <text x="680" y="250" font-family="Arial, sans-serif" font-size="10" fill="#0c5460">
      ③ Tidak melibatkan server
    </text>
    <text x="680" y="265" font-family="Arial, sans-serif" font-size="10" fill="#0c5460">
      ④ Eksekusi langsung di browser
    </text>
  </g>
  
  <!-- Comparison Table -->
  <g id="comparison">
    <text x="500" y="320" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#2c3e50">
      Perbandingan Tipe XSS
    </text>
    
    <!-- Table Header -->
    <rect x="100" y="340" width="800" height="40" fill="#34495e" stroke="#2c3e50" stroke-width="2"/>
    <text x="200" y="365" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="white">
      Aspek
    </text>
    <text x="360" y="365" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="white">
      Reflected XSS
    </text>
    <text x="560" y="365" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="white">
      Stored XSS
    </text>
    <text x="760" y="365" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="white">
      DOM-based XSS
    </text>
    
    <!-- Row 1: Penyimpanan -->
    <rect x="100" y="380" width="800" height="50" fill="#ecf0f1" stroke="#bdc3c7" stroke-width="1"/>
    <text x="200" y="408" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="#2c3e50">
      Penyimpanan
    </text>
    <text x="360" y="408" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#34495e">
      Tidak disimpan
    </text>
    <text x="560" y="408" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#34495e">
      Disimpan di server
    </text>
    <text x="760" y="408" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#34495e">
      Tidak disimpan
    </text>
    
    <!-- Row 2: Delivery -->
    <rect x="100" y="430" width="800" height="50" fill="#ffffff" stroke="#bdc3c7" stroke-width="1"/>
    <text x="200" y="458" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="#2c3e50">
      Penyebaran
    </text>
    <text x="360" y="458" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#34495e">
      Via URL/Link
    </text>
    <text x="560" y="458" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#34495e">
      Otomatis saat akses
    </text>
    <text x="760" y="458" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#34495e">
      Via URL/Parameter
    </text>
    
    <!-- Row 3: Impact -->
    <rect x="100" y="480" width="800" height="50" fill="#ecf0f1" stroke="#bdc3c7" stroke-width="1"/>
    <text x="200" y="508" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="#2c3e50">
      Tingkat Bahaya
    </text>
    <text x="360" y="508" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#f39c12">
      Sedang
    </text>
    <text x="560" y="508" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#e74c3c">
      Tinggi
    </text>
    <text x="760" y="508" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#f39c12">
      Sedang-Tinggi
    </text>
    
    <!-- Row 4: Server Involvement -->
    <rect x="100" y="530" width="800" height="50" fill="#ffffff" stroke="#bdc3c7" stroke-width="1"/>
    <text x="200" y="558" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="#2c3e50">
      Peran Server
    </text>
    <text x="360" y="558" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#34495e">
      Me-reflect payload
    </text>
    <text x="560" y="558" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#34495e">
      Menyimpan payload
    </text>
    <text x="760" y="558" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#34495e">
      Tidak terlibat
    </text>
    
    <!-- Row 5: Detection -->
    <rect x="100" y="580" width="800" height="50" fill="#ecf0f1" stroke="#bdc3c7" stroke-width="1"/>
    <text x="200" y="608" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="#2c3e50">
      Deteksi
    </text>
    <text x="360" y="608" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#34495e">
      Mudah (WAF)
    </text>
    <text x="560" y="608" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#34495e">
      Mudah (scanner)
    </text>
    <text x="760" y="608" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#34495e">
      Sulit (client-side)
    </text>
  </g>
  
  <!-- Prevention Tips -->
  <g id="prevention">
    <rect x="100" y="660" width="800" height="120" rx="10" fill="#d4edda" stroke="#28a745" stroke-width="2"/>
    <text x="500" y="685" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#155724">
      Cara Mencegah XSS
    </text>
    
    <text x="120" y="710" font-family="Arial, sans-serif" font-size="11" fill="#155724">
      • <tspan font-weight="bold">Input Validation:</tspan> Validasi semua input dari pengguna dengan whitelist
    </text>
    <text x="120" y="728" font-family="Arial, sans-serif" font-size="11" fill="#155724">
      • <tspan font-weight="bold">Output Encoding:</tspan> Encode karakter khusus sebelum ditampilkan (&lt; menjadi &amp;lt;)
    </text>
    <text x="120" y="746" font-family="Arial, sans-serif" font-size="11" fill="#155724">
      • <tspan font-weight="bold">Content Security Policy (CSP):</tspan> Batasi sumber script yang boleh dieksekusi
    </text>
    <text x="120" y="764" font-family="Arial, sans-serif" font-size="11" fill="#155724">
      • <tspan font-weight="bold">HTTPOnly Cookies:</tspan> Cegah JavaScript mengakses session cookies
    </text>
  </g>
</svg>
